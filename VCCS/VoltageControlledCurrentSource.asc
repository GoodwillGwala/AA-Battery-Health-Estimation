Version 4
SHEET 1 1308 820
WIRE 352 -160 112 -160
WIRE -464 -128 -544 -128
WIRE 352 -128 352 -160
WIRE 112 -96 112 -160
WIRE 224 -80 112 -80
WIRE -64 -64 -80 -64
WIRE -64 -32 -64 -64
WIRE -96 -16 -240 -16
WIRE 64 0 64 -16
WIRE 64 0 -32 0
WIRE 224 0 224 -16
WIRE 224 0 112 0
WIRE -96 16 -128 16
WIRE -64 64 -64 32
WIRE -240 128 -240 -16
WIRE 112 128 112 0
WIRE 112 128 -240 128
WIRE 112 176 112 128
WIRE -640 224 -640 208
WIRE -624 224 -640 224
WIRE -528 224 -528 208
WIRE -528 224 -544 224
FLAG -64 -64 Vcc
FLAG -128 16 In
IOPIN -128 16 In
FLAG -528 224 Vcc
FLAG -640 208 0
FLAG 112 256 0
FLAG -624 -128 0
FLAG -464 -128 In
FLAG -64 64 0
FLAG 112 -160 Load
IOPIN 112 -160 BiDir
FLAG 112 128 Shunt
IOPIN 112 128 BiDir
SYMBOL Opamps\\opamp2 -64 -64 R0
WINDOW 3 -93 241 Left 2
SYMATTR Value LMx58_LM2904
SYMATTR InstName U1
SYMBOL voltage -528 224 R90
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 9
SYMBOL nmos 64 -96 R0
SYMATTR InstName M1
SYMATTR Value IRF530
SYMBOL res 96 160 R0
SYMATTR InstName R3
SYMATTR Value 1
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL voltage -528 -128 R90
WINDOW 123 34 126 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 34 154 Left 2
SYMATTR Value2 AC 0.1 0
SYMATTR Value 0.2
SYMATTR InstName V4
SYMBOL diode 240 -16 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL BatteryModel 352 -96 R270
SYMATTR InstName U2
TEXT -728 792 Left 2 ;.lib LMx58_LM2904.CIR
TEXT 16 -176 Center 4 ;VCCS
TEXT 728 264 Left 2 !.ac dec 101 1 15000000
TEXT 728 336 Left 2 ;.ac dec 10 1 1K
TEXT -224 104 Left 2 !.inc LMx58_LM2904_AI.CIR
TEXT -728 616 Left 2 ;NOTES:\nUse "opamp2" symbol.\nChange its Value from "opamp2" to either\n"LMx58_LM2904" or "LMx24_LM2902".\nAdd SPICE Directive with ".inc" and the same model's filename.
TEXT 288 200 Left 2 !.lib BatteryModel.lib
RECTANGLE Normal 48 816 -752 592 2
RECTANGLE Normal -384 336 -720 -224 2
RECTANGLE Normal 1008 512 -288 -240 2
RECTANGLE Normal 960 496 704 224 2
